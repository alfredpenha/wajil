---
import { AnalyticsEvents } from '../../lib/analytics';
import { baseFromPath, buildSrcset, withBase } from '../../lib/images';
import ButtonGold from '../ui/ButtonGold.astro';

const { hero, uberEats } = Astro.props;
const desktopBase = baseFromPath(hero.image.desktop.fallback);
const mobileBase = baseFromPath(hero.image.mobile.fallback);
const desktopWidths = [960, 1280];
const mobileWidths = [540, 720];
const desktopAvif = buildSrcset(desktopBase, desktopWidths, 'avif');
const desktopWebp = buildSrcset(desktopBase, desktopWidths, 'webp');
const desktopJpg = buildSrcset(desktopBase, desktopWidths, 'jpg');
const mobileAvif = buildSrcset(mobileBase, mobileWidths, 'avif');
const mobileWebp = buildSrcset(mobileBase, mobileWidths, 'webp');
const mobileJpg = buildSrcset(mobileBase, mobileWidths, 'jpg');
const mobileFallback = withBase(hero.image.mobile.fallback ?? hero.image.desktop.fallback);
---
<section id="inicio" class="section-x pb-10 pt-8 md:pb-20">
  <div class="section-inner grid items-center gap-10 md:grid-cols-[1.05fr_0.95fr]">
    <div class="space-y-6 fade-up">
      <h1 class="balance-text text-4xl font-semibold leading-tight text-sand md:text-6xl">
        {hero.title}
      </h1>
      <p class="balance-text max-w-xl text-base leading-relaxed text-fog md:text-lg">
        {hero.subcopy}
      </p>
      <div class="flex flex-col gap-4 sm:flex-row sm:items-center">
        <ButtonGold
          href={uberEats.href}
          dataTrack={AnalyticsEvents.uberEatsHero}
          ariaLabel={`${uberEats.label} - Hero`}
        >
          {uberEats.label}
        </ButtonGold>
        <span class="text-xs uppercase tracking-[0.25em] text-fog">{hero.trust}</span>
      </div>
    </div>
    <div class="relative fade-up-slow">
      <div class="absolute inset-0 rounded-card bg-gradient-to-t from-ink/80 via-ink/30 to-transparent md:hidden"></div>
      <picture>
        <source
          media="(min-width: 768px)"
          srcset={desktopAvif}
          sizes="(min-width: 1280px) 50vw, (min-width: 768px) 45vw, 100vw"
          type="image/avif"
        />
        <source
          media="(min-width: 768px)"
          srcset={desktopWebp}
          sizes="(min-width: 1280px) 50vw, (min-width: 768px) 45vw, 100vw"
          type="image/webp"
        />
        <source
          media="(min-width: 768px)"
          srcset={desktopJpg}
          sizes="(min-width: 1280px) 50vw, (min-width: 768px) 45vw, 100vw"
          type="image/jpeg"
        />
        <source srcset={mobileAvif} sizes="100vw" type="image/avif" />
        <source srcset={mobileWebp} sizes="100vw" type="image/webp" />
        <source srcset={mobileJpg} sizes="100vw" type="image/jpeg" />
        <img
          class="aspect-[9/16] w-full max-h-[60vh] rounded-card border border-fog/15 object-cover object-[50%_75%] md:aspect-[16/9] md:max-h-none md:object-center"
          src={mobileFallback}
          alt={hero.image.alt}
          width="1024"
          height="1536"
          srcset={mobileJpg}
          sizes="100vw"
          loading="eager"
          fetchpriority="high"
          decoding="async"
        />
      </picture>
    </div>
  </div>
</section>
