---
import { AnalyticsEvents } from '../../lib/analytics';
import { baseFromPath, buildSrcset, withBase } from '../../lib/images';
import ButtonGold from '../ui/ButtonGold.astro';
import Card from '../ui/Card.astro';

const { origin, uberEats } = Astro.props;
const originBase = baseFromPath(origin.image.fallback);
const originWidths = [960, 1280];
const originAvif = buildSrcset(originBase, originWidths, 'avif');
const originWebp = buildSrcset(originBase, originWidths, 'webp');
const originJpg = buildSrcset(originBase, originWidths, 'jpg');
const originFallback = withBase(origin.image.fallback);
---
<section id="origen" class="section-x relative overflow-hidden border-t border-fog/10 py-16">
  <picture>
    <source srcset={originAvif} sizes="100vw" type="image/avif" />
    <source srcset={originWebp} sizes="100vw" type="image/webp" />
    <img
      class="absolute inset-0 h-full w-full object-cover"
      src={originFallback}
      alt={origin.image.alt}
      width="1536"
      height="1024"
      srcset={originJpg}
      sizes="100vw"
      loading="lazy"
      decoding="async"
    />
  </picture>
  <div class="absolute inset-0 bg-gradient-to-r from-ink via-ink/90 to-transparent"></div>
  <div class="absolute inset-0 bg-ink/10 mix-blend-multiply"></div>

  <div class="section-inner fade-up">
    <Card class="max-w-xl space-y-5 bg-ink/55 p-8 backdrop-blur-[2px]">
      <h2 class="section-title">{origin.title}</h2>
      <p class="text-sm leading-relaxed text-fog md:text-base">{origin.body}</p>
      <ButtonGold
        href={uberEats.href}
        dataTrack={AnalyticsEvents.uberEatsOrigin}
        ariaLabel={`${origin.ctaLabel} - Origen`}
      >
        {origin.ctaLabel}
      </ButtonGold>
    </Card>
  </div>
</section>
